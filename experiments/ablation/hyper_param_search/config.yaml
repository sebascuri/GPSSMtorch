experiment:
  name: ablation/hyper_param_search  # Experiment name.
  splits:
    - ['optimization', 'learning_rate'] # These are all the different experiments runner will parse.
    - ['optimization', 'batch_size']
    - ['model', 'num_particles']
    - ['model', 'recognition', 'kind']
    - ['model', 'independent_particles']
    - ['model', 'loss_factors', 'kl_u']
    - ['model', 'forward', 'kernel', 'shared']
    - ['model', 'forward', 'kernel', 'outputscale']

dataset:
  name: Actuator
  sequence_length: 50  # Length of training mini-batch sequence.
  sequence_stride: 1  # Stride of mini-batch sequence (useful for large datasets).

optimization:
  learning_rate:
    - 0.1
    - 0.01
    - 0.005
    - 0.001
    - 0.0001
  batch_size:
    - 10
    - 16
    - 32
    - 64
  num_epochs: 50  # Number of epochs to train the data.

model:
  name: 'PRSSM'
  dim_states: 4  # Number of internal states.
  num_particles:
    - 10
    - 25
    - 50
  # Number of particles for forwards/backwards sampling.
  loss_key: 'elbo'  # This string identifies which loss to use.
  k_factor: 1 # This is the soft conditioning factor.
  independent_particles:
    - True
    - False
  loss_factors:  # These factors multiply each term of the ELBO.
    kl_u:
      - 1.0
      - 0.1
      - 0.5
      - 10.
    # KL-divergence of the variational distribution (with prior) of the forward model factor.
    kl_conditioning: 1.0 # KL-divergence of the conditioning step (prediction vs. conditioning).
  recognition:
    length: 16  # Length of recognition sequence.
    kind:
      - 'output'
      - 'conv'
      - 'lstm'
    variance: 0.01  # Initial variance estimate.
    learnable: True  # Learnable parameters flag.
  emissions:
    variance: 1.0   # Initial variance estimate.
    learnable: True # Learnable parameters flag.
  transitions:
    variance: 0.000004  # Initial variance estimate.
    learnable: True  # Learnable parameters flag.
  forward:  # If backwards is empty, it will make a copy of the same GP for the backwards pass.
    mean:
      kind: 'zero'  # Strategies: zero, constant, linear.
    kernel:
      shared:
        - True
        - False
      kind: 'rbf'  # Strategies: rbf, matern 1/2, matern 3/2, matern 5/2, linear
      ard_num_dims:  # Number of ard dimensions. if empty will automatically select dim_states + dim_inputs.
      outputscale:
        - 0.1
        - 0.25
        - 0.5
      lengthscale: 2.0  # Initial lengthscale estimate.
      learn_outputscale: True  # Learnable parameters flag.
      learn_lengthscale: True  # Learnable parameters flag.
    inducing_points:
      number_points: 20  # Number of inducing points per (GP).
      strategy: 'uniform'  # Initialization strategies: normal, uniform, or linspace.
      scale: 4.0  # Scale of initialization (it will be centered around 0, hence for [-1, 1] set scale = 2).
      learnable: True  # Learnable parameters flag.
    variational_distribution:
      kind: 'mean'  # Strategies: full, mean, sample, delta
      mean: 0.0025
      variance: 0.0001
      learn_mean: True  # Learnable parameters flag.
      learn_var: True # Learnable parameters flag.